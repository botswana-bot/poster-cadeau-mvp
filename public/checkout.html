<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Checkout — Poster MVP</title>
    <link rel="stylesheet" href="/app.css" />
  </head>
  <body>
    <header class="header">
      <div class="headerInner">
        <a class="brand" href="/"><span class="brandDot"></span>Poster cadeau</a>
        <div class="headerActions">
          <span class="pillBtn">Étape 3/4</span>
        </div>
      </div>
    </header>

    <main class="container">
      <h1 class="h1">Commander</h1>

      <div class="card" style="max-width:720px">
        <div class="cardBody">
          <div class="cardTitle">Poster A4</div>
          <p class="cardText"><b>19€</b> (livraison en plus)</p>
        </div>
        <div class="meta" id="meta"></div>
        <div class="notice" style="margin-top:10px">Livraison en plus (placeholder). France métropolitaine.</div>
      </div>

      <div class="hr"></div>
      <div style="display:flex;gap:12px;flex-wrap:wrap;align-items:center">
        <button class="btn primary" id="pay">Payer (simulé)</button>
        <a href="#" id="back" class="btn">Retour</a>
      </div>
      <div style="margin-top:10px" class="notice">Stripe + calcul livraison seront branchés après validation du concept.</div>
    </main>

    <script type="module">
      import { loadCreation, qs, escapeHtml, STYLES, setStatus } from "/app.js";

      const id = qs('id');
      const cr = id ? loadCreation(id) : null;

      if (!cr) {
        document.querySelector('#meta').textContent = "Création introuvable.";
      } else {
        const style = STYLES.find(s => s.id === cr.styleId);
        document.querySelector('#meta').innerHTML = `Style: <b>${escapeHtml(style?.name || cr.styleId)}</b><br/>Tagline: <b>${escapeHtml(cr.tagline)}</b>`;
        document.querySelector('#back').href = `/preview.html?id=${encodeURIComponent(id)}`;

        document.querySelector('#pay').addEventListener('click', () => {
          setStatus(id, 'ready_for_pod');
          location.href = `/order.html?id=${encodeURIComponent(id)}`;
        });
      }
    </script>
  </body>
</html>
